{
    # Global options block (optional)
    # Change default options for all sites, e.g., logging or timeouts
    auto_https disable_redirects  # If HTTPS isn't configured
}

:80 {
    # Set maximum body size for client requests
    @large_body {
        header Content-Length > 10M
    }
    respond @large_body 413

    # Serve static files for /api/static/
    handle_path /api/static/* {
        root * /var/www/static
        file_server
    }

    # Proxy everything else to the upstream app
    reverse_proxy * farmers-market-backend-production.up.railway.app {
        header_up Host {host}
        header_up X-Real-IP {remote_host}
        header_up X-Forwarded-For {remote_host}
        header_up X-Forwarded-Proto {scheme}
    }
}
